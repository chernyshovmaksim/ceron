# Sass Parser

> A simple npm package to parse a `sass` file into a consumable `json` data

[![Build Status](https://img.shields.io/travis/bstashio/sass-parser/master.svg?style=flat-square)](https://travis-ci.org/bstashio/sass-parser)
[![Coverage Status](https://img.shields.io/coveralls/github/bstashio/sass-parser/master.svg?style=flat-square)](https://coveralls.io/github/bstashio/sass-parser?branch=master)
[![npm version](https://img.shields.io/npm/v/sass-parser.svg?style=flat-square)](http://npm.im/sass-parser)
[![Greenkeeper badge](https://img.shields.io/badge/Greenkeeper-enabled-brightgreen.svg?style=flat-square)](https://greenkeeper.io/)
[![MIT License](https://img.shields.io/npm/l/express.svg?style=flat-square)](http://opensource.org/licenses/MIT)

## What it does

This is a simple package that does a simple task of going through a `sass` file
and extracting relevant details of `variables`, `mixins`, and `functions` 
contained within that file. 

Currently it only supports `sass` **old syntax**; meaning, 
it does NOT handle the newer `scss` syntax.  For more details about this, 
have a look at [Sass Syntax](http://sass-lang.com/documentation/file.SASS_REFERENCE.html#Syntax).

The extracted data is useful for usage in documentation or any other similar needs.

## Install

```sh
$ npm install sass-parser
```

## Usage

### Parsing a file

```js
const parse = require('sass-parser')();

parse.file('index.sass').then( data => console.log( data ) );
```

#### Output of `parse.file`

```js
{
  variables: {
    var_1: {
      id: 'var_1',
      name: '$var_1',
      value: '#000'
    },
    var_2: ...,
    var_3: ...
  },
  mixins: {
    mix_1: {
      name: 'mix_1',
      parameters: [
        '$param_1',
        ...
      ]
    },
    mix_2: ...,
    mix_3: ...
  },
  functions: {
    fn_1: {
      name: 'fn_1',
      parameters: [
        '$param_1',
        ...
      ]
    },
    fn_2: ...,
    fn_3: ...
  }
}
```

### Parsing a variable

```js
parse.variable( '$white: #fff !default' );

// output
{
  id: 'white',
  name: '$white',
  value: '#fff'
}
```

### Parsing a mixin

```js
parse.mixin( '=mix( $color )' );

// output
{
  name: 'mix',
  parameters: [
    '$color'
  ]
}
```

### Parsing a function

```js
parse.function( '@function do_something( $this, $that )' );

// output
{
  name: 'do_something',
  parameters: [
    '$this',
    '$that'
  ]
}
```

## Options

### Default options:

```js
{
  regex: {
    variable: {
      pattern: '^\\$(.*?):\\s*([^;]+)\\s*([^;]+)\\!(global|default)',
      flags  : 'g',
    },
    mixin_name: {
      pattern: '^=((?!\\d)[\\w_-][\\w\\d_-]*)',
      flags  : 'gi',
    },
    mixin: {
      pattern: '^=((?!\\d)[\\w_-][\\w\\d_-]*)\\s*\\(\\s*([^\\)"]+)?.',
      flags  : 'gi',
    },
    function_name: {
      pattern: '^@function\\s*?((?!\\d)[\\w_-][\\w\\d_-]*)',
      flags  : 'gi',
    },
    function: {
      pattern: '^@function\\s*?((?!\\d)[\\w_-][\\w\\d_-]*)\\s*\\(\\s*([^\\)"]+)?.',
      flags  : 'gi',
    },
  },

  // ---------------------------------------------------------------------------
  
  line_by_line: {
    skipEmptyLines: true,
  },

  // ---------------------------------------------------------------------------
  
  keys: {
    
    variables: 'variables',
    variable : {
      id    : 'id',
      name  : 'name',
      value : 'value',
    },

    // -------------------------------------------------------------------------
    
    mixins: 'mixins',
    mixin : {
      name      : 'name',
      parameters: 'parameters',
    },

    // -------------------------------------------------------------------------
    
    functions: 'functions',
    function : {
      name      : 'name',
      parameters: 'parameters',
    },
    
  }
}
```

### Example of using custom options:

```js
const parser = require('sass-parser');
const parse  = parser({
  keys: {
    variables: 'vars',
    mixin: {
      parameters: 'param',
    },
    function: {
      name: 'fn',
    }
  }
});

parse.file('index.sass').then( data => console.log( data ) );
```

#### Output after applying custom options

```js
{
  vars: {           // <== now it's 'vars' instead of 'variables'
    var_1: {
      id: 'var_1',
      name: '$var_1',
      value: '#000'
    },
    var_2: ...,
    var_3: ...
  },
  mixins: {
    mix_1: {
      name: 'mix_1',
      param: [      // <== now it's 'param' instead of 'parameters'
        '$param_1',
        ...
      ]
    },
    mix_2: ...,
    mix_3: ...
  },
  functions: {
    fn_1: {
      fn: 'fn_1',   // <== now it's 'fn' instead of 'name'
      parameters: [
        '$param_1',
        ...
      ]
    },
    fn_2: ...,
    fn_3: ...
  }
}
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### options

Default options are set here.

Can be extended when requiring the module by passing a custom options object.

### variable

Parses line to get sass variable

**Parameters**

-   `line` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

### chunk

Parses line to get sass mixin or function

**Parameters**

-   `line` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `what` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

### function

Parses line to get sass function

**Parameters**

-   `line` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

### mixin

Parses line to get sass mixin

**Parameters**

-   `line` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

### file

Parses a sass file line by line 
and populates returned data with variables, mixins and functions

**Parameters**

-   `file` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

## License

MIT Â© [bstashio](https://github.com/bstashio)
